(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[374],{7266:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/birthday-attack",function(){return t(9664)}])},6741:function(e,n,t){"use strict";var i=t(5893),r=(t(7294),t(63)),a=t(5697),o=t.n(a);function s(){var e,n,t=(e=["\n  font-size: 70px;\n  font-weight: 400;\n  letter-spacing: -1px;\n  line-height: 1.1;\n  margin-bottom: 3%;\n  @media (max-width: 767px) {\n    font-size: 54px;\n  }\n"],n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}})));return s=function(){return t},t}var h=r.ZP.h1(s());function c(e){var n=e.title;return(0,i.jsx)(h,{children:n})}c.propTypes={title:o().string.isRequired},c.defaultProps={},n.Z=c},9832:function(e,n,t){"use strict";t.d(n,{XF:function(){return h},U7:function(){return c},Z0:function(){return u}});var i=t(63);function r(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function a(){var e=r(["\n    text-rendering: optimizeLegibility;\n    -webkit-font-smoothing: antialiased;\n    color: #f5f8fa;\n    text-shadow: none;\n    font-size: 1.125rem;\n    line-height: 1.5;\n    margin-bottom: 5em;\n"]);return a=function(){return e},e}function o(){var e=r(["\n    font-size: 32px;\n    margin: .4em 0;\n    font-weight: 500;\n\n    @media (max-width: 983px) {\n      font-size: 26px;\n    }\n"]);return o=function(){return e},e}function s(){var e=r(["\n    margin: "," 0;\n    border: none;\n    background: ",";\n    height: 2px;\n"]);return s=function(){return e},e}var h=i.ZP.div(a()),c=i.ZP.h2(o()),u=i.ZP.hr(s(),(function(e){return e.gap?e.gap:"16px"}),(function(e){return e.bg?e.bg:"#f5f8fa"}))},9664:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return y}});var i=t(5893),r=(t(7294),t(9008)),a=t(63),o=t(9832),s=t(9825),h=t(6741),c=t(5225),u=t(5711);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var d=function(e,n,t){window.katex&&n&&window.katex.render(e,n,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},i=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),i.forEach((function(n){l(e,n,t[n])}))}return e}({},t,{throwOnError:!0}))},p=t(8790);function f(){var e,n,t=(e=["\n  font: normal 16px monospace;\n  background-color: ",";\n  border: 1px solid ",";\n  padding: 12px;\n  margin: 16px 0;\n  border-radius: 2px;\n"],n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}})));return f=function(){return t},t}var b=a.ZP.div(f(),p.Z.LIGHT_PURPLE,p.Z.LIGHT_WHITE),m=function(e,n){return d(e,n,{displayMode:!0})},x=function(e,n){return d(e,n,{displayMode:!1})},g=(0,i.jsxs)(b,{children:["n1-n2,n1-n3\u2026,n1-n23 [22 comparison]",(0,i.jsx)("br",{}),"+ n2-n3,n2-n3,...,n2-n23 [21 comparison]",(0,i.jsx)("br",{}),"+ n3-n4,...,n3-n23 [20 comparison]",(0,i.jsx)("br",{}),"+ ...",(0,i.jsx)("br",{}),"+ n22-n23 [1 comparison]",(0,i.jsx)("hr",{}),"= 253 comparison"]}),j=(0,i.jsxs)(b,{children:["The probability of not sharing a birthday in a room of 23 people comes out to be,",(0,i.jsx)("div",{ref:function(e){return m("(365/365) * (364/365) * (363/365) * (362/365) \u2026\u2026 * (342/365) \\sim 0.49",e)}}),"Hence, the probability of sharing a birthday in a room of 23 people.",(0,i.jsx)("div",{ref:function(e){return m("1 - 0.49 = 0.51",e)}}),(0,i.jsx)("div",{ref:function(e){return m("1 - \\frac{365!}{(365-n)! * (365^n)} = 0.51",e)}}),(0,i.jsx)("div",{ref:function(e){return m("\\approx 50\\%",e)}}),(0,i.jsx)("hr",{}),(0,i.jsx)("div",{ref:function(e){return m("p_M(n) = 1 - \\frac{M!}{(M-n)!M^n}",e)}})]});var y=function(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.default,{children:[(0,i.jsx)("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css",integrity:"sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB",crossOrigin:"anonymous"}),(0,i.jsx)("script",{defer:!0,src:"https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js",integrity:"sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p",crossOrigin:"anonymous"}),(0,i.jsx)("script",{defer:!0,src:"https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js",integrity:"sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR",crossOrigin:"anonymous",onLoad:"renderMathInElement(document.body);"}),(0,i.jsx)("style",{children:" .katex-display > .katex { text-align: left; overflow: auto hidden;} "})]}),(0,i.jsx)(c.Z,{children:(0,i.jsx)(u.PU,{children:(0,i.jsxs)(o.XF,{children:[(0,i.jsx)(h.Z,{title:"Birthday Attack"}),(0,i.jsx)(o.Z0,{}),"A Birthday Attack is a brute force cryptographic attack which exploits the possibility of a hash collision. This exploit cracks the mathematics behind the birthday paradox through which the chance of sharing one birthday by two people is quite higher than one may think.",(0,i.jsx)(o.U7,{children:"The Birthday Paradox"}),'Suppose if there are "n" number of people in a room, there is a probability that some of them might have their birthdays on a similar day. Intuitively this probability might seem small. But, actually its about 50% (r1) chance that two people might share the same birthday in a room of 23 people (n=23) and this reaches 99.9% (r2) if the number of people in room are 75 (n=75).',(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),'One important point to consider here is that we don"t care which two people share a birthday. To arrive at this 50% (r1) probability of a birthday match in a room of 23 people we form 253 pairs/comparisons.',(0,i.jsx)("br",{}),(0,i.jsx)(s.Z,{header:(0,i.jsx)("p",{children:"Comparisons Derivation"}),body:g,collapsed:!0,style:{global:{margin:"1em 0 0 0 !important"}}}),"Whereas, if we did consider which person share a birthday i.e we fix a person/birthday and search for a person with similar birthday then we would need 253 people (n=253) to get same number of pairs/comparisons and arrive at same 50% (r3) probability.",(0,i.jsx)(o.U7,{children:"Maths behind The Birthday Paradox"}),"According to the pigeonhole principle, if n items are put into m containers, with n>m, then at least one container must contain more than one item.",(0,i.jsx)("br",{}),"In relation to the birthday paradox, the pigeonhole principle can be used to intuitively see that as the number of people grow larger (or approach 367), at least 2 people will have to be assigned to a certain \u201cbox\u201d (birthday) since there are only 366 possible birthdays, resulting in people having the same birthday.",(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),"Note: To simplify the calculation we will not consider leap year and assume every birthday has an equal occurrence chance.",(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),"Instead of calculating the chance of two people sharing a birthday in a room we calculate the opposite i.e chances of two people not sharing a birthday. By this approach, the first person can have any birthday so 365/365 chance, for second person not to share a birthday its 364/365 (excluding the birthday of the first person), for third is 363/365 \u2026 so on.",(0,i.jsx)(s.Z,{header:(0,i.jsx)("p",{children:"Equation Derivation"}),body:j,collapsed:!0,style:{global:{margin:"1em 0 0 0 !important"}}}),"It turns out that \xa0",(0,i.jsx)("span",{ref:function(e){return x("p_M(n) = 0.5",e)}}),"\xa0 when n is on the order of \xa0",(0,i.jsx)("span",{ref:function(e){return x("\\sqrt M",e)}}),"\xa0.",(0,i.jsx)("br",{}),"Suppose, we have a hash algo which gives a output of 64-bit. Total hashes possible would be \xa0",(0,i.jsx)("span",{ref:function(e){return x("2^{64}",e)}}),"\xa0 i.e ",(0,i.jsx)("span",{ref:function(e){return x("M = 2^{64}",e)}}),". This means, we have a 50% chance of collision after only",(0,i.jsx)("span",{ref:function(e){return x("2^{32}",e)}})," tries.",(0,i.jsx)("br",{}),"For a 128 bit digest, this requires ",(0,i.jsx)("span",{ref:function(e){return x("2^{64}",e)}}),"\xa0 (",(0,i.jsx)("span",{ref:function(e){return x("\\sim 10^9",e)}}),")\xa0 tries. (That is computationally infeasible)",(0,i.jsx)(o.U7,{children:"Birthday Paradox exploitation in hashing"}),"Hash function is a versatile one-way* cryptographic algorithm that maps an input (message) of any size to a unique output of a fixed length of bits (message digest).",(0,i.jsx)(b,{children:(0,i.jsxs)("code",{children:["def hash_it(input: int):",(0,i.jsx)("br",{}),"\xa0\xa0return input % 1024",(0,i.jsx)("br",{})]})}),"Our simple hashing approach would take the modular of the integer passed and return a output of a fixed range (0\u20131023). Our hash function does not map our passed params to unique indexes. This anomaly of a hash function is known as a hash collision.",(0,i.jsx)("br",{}),'According to the Pigeonhole Principle, it is impossible to avoid hash collisions, unless the size of the output is at least as large as the input (which defeat"s the purpose of a hash function).',(0,i.jsx)("br",{}),(0,i.jsx)(o.U7,{children:"Exploitation in action"}),'Suppose "A" wants to share a document with "B".\xa0\xa0"A" signs the document by n-bit hash code.',(0,i.jsx)("br",{}),'Now,\xa0\xa0evil "C" can generate ',(0,i.jsx)("span",{ref:function(e){return x("2^{n}",e)}}),"versions of the document (appending space, blank line, etc to output different hash but still maintaining the document visually alike to the original), generate\xa0",(0,i.jsx)("span",{ref:function(e){return x("2^{n}",e)}})," versions of the evil document, and see which pair hashes to the same value.",(0,i.jsx)("br",{}),"The probability that there is a benign document and an evil document with the same hash is greater>0.5 i.e\xa0",(0,i.jsx)("span",{ref:function(e){return x("O(\\sqrt N)",e)}}),". If no match found, additional valid and fraudulent document are generated until a match is made.",(0,i.jsx)("br",{}),'"C" then presents the benign document for "B" to agree to, and now he has the evil document with the same signature. This attack is called a "collision attack"; as the attacker is looking for a "collision".',(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),'On the other hand, if "C" has no control over the good document, this doesn"t work. He can, of course, create \ud835\udc41 evil documents and see if there is one with the same hash as the good one, however the probability  of that happening is significantly smaller if \ud835\udc41 is large it goes upto \xa0',(0,i.jsx)("span",{ref:function(e){return x("O(N)",e)}}),'. This attack is called a "second preimage attack", that is, find a second message that hashes to the same value as a given one. If the source document is already fixed then we can do a pre-image attack where we try to find a message that has a specific hash value.']})})})]})}}},function(e){e.O(0,[63,496,774,888,179],(function(){return n=7266,e(e.s=n);var n}));var n=e.O();_N_E=n}]);